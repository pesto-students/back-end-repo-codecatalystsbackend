const openAiApiCall = async (
    category = "",
  ) => {
    const url = `${process.env.OPENAI_API_URL}/chat/completions`;
    const apiKey = process.env.OPEN_API_KEY;
    console.log("URL__,url",url);
    const request_content = `
        Create 10 objective questions sets for quiz with answer, 
        for category "${category}",  
        Each question should have 4 options and  the correct answer stored in the answer variable based on the right option. 
        The output format should match the provided sample output 'answer' value may be vary based on right option which is generated by you, 
        don't use same answer pattern use random,  
        sample json output structure is {
            questions :
            [
                { 
                    question: "what is print function in python?", 
                    options: {
                        a: "print the given value", 
                        b: "return sum of given number", 
                        c: "convert string in to upper case", 
                        d: "convert string in to lover case"
                    }, 
                    answer: "a" 
                }, 
                { 
                    question: "what is f'' in python?", 
                    options: { 
                        a: "print the given value", 
                        b: "return sum of given number", 
                        c: "convert string in to captital case", 
                        d: "for cancat string" 
                    }, 
                    answer: "d"
                },  
            ]
        }`

    const requestData = {
        model: 'gpt-3.5-turbo-1106',
        response_format: { type: 'json_object' },
        messages: [
            {
                role: 'system',
                content: 'You are a helpful assistant designed to output JSON.'
            },
            {
                role: 'user',
                content: request_content
            }
        ]
    };

    try {
        const response = await fetch(url, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${apiKey}`
            },
            body: JSON.stringify(requestData),
        });

        if (!response.ok) {
            throw new Error(`HTTP error! Status: ${response.status}`);
        }

        const responseData = await response.json();
        console.log(responseData);

        return responseData;
    } catch (error) {
        console.error('Error:', error);
    }
  }

module.exports = openAiApiCall;  